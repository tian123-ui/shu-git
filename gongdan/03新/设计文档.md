# 商品 360 看板综合设计文档（含数据分层、工单与测试）

## 一、设计目标

本设计文档旨在构建一套涵盖数据分层架构、工单处理机制及测试验证体系的商品 360 看板完整解决方案。通过ods->dim->dwd->dws->ads的数据分层架构实现数据的规范化处理与高效应用，结合工单系统保障业务问题的闭环处理，同时通过全面的测试验证确保看板数据的准确性与可靠性，最终为商家提供全面、精准的商品运营决策支持。

## 二、数据分层架构设计（ods->ads）

### （一）分层逻辑与作用

数据仓库采用经典的五层架构，实现数据从原始采集到应用输出的全流程加工，各层作用如下：

|   |   |   |
|---|---|---|
|分层|核心作用|数据处理方式|
|ods|存储未加工的原始业务数据|直接接入业务系统原始日志与订单数据，不做清洗|
|dim|存储商品、用户等基础维度信息|对基础属性进行标准化定义，建立维度关联关系|
|dwd|存储清洗后的业务明细数据|对原始数据去重、补全、格式转换，生成原子明细|
|dws|存储按维度汇总的指标数据|按时间、商品、用户等维度聚合明细数据，生成汇总指标|
|ads|存储直接供看板使用的应用层数据|基于汇总指标计算业务场景化指标，支持可视化展示|

### （二）各层核心表设计

1. **ods****层**（5 张表）

- ods_sales_original：销售原始记录表（订单时间、商品 ID、SKU ID 等）

- ods_traffic_original：流量原始记录表（访问时间、渠道、访客 ID 等）

- ods_user_behavior_original：用户行为原始记录表（搜索词、访问路径等）

- ods_content_original：内容原始记录表（内容类型、曝光量等）

- ods_comment_original：评价原始记录表（评分、评价内容等）

2. **dim****层**（4 张表）

- dim_platform_channel：平台渠道维度表（平台 ID、渠道类型等）

- dim_product_sku：商品 SKU 维度表（商品名称、所属类目等）

- dim_user：用户维度表（注册时间、会员等级等）

- dim_price_band：价格带维度表（价格区间、所属类目等）

3. **dwd****层**（5 张表）

- dwd_sku_sales_detail：SKU 销售明细表（每日销量、库存余量等）

- dwd_traffic_channel_detail：流量渠道明细表（访客数、转化率等）

- dwd_title_keyword_detail：标题关键词明细表（搜索次数、词根转化率等）

- dwd_content_effect_detail：内容效果明细表（点击率、转化量等）

- dwd_rfm_behavior_detail：RFM 行为明细表（最近消费时间、累计金额等）

4. **dws****层**（4 张表）

- dws_sales_summary：销售汇总表（总营收、新客订单占比等）

- dws_price_analysis_summary：价格分析汇总表（价格趋势、价格力星级等）

- dws_rfm_summary：RFM 汇总表（RFM 得分、用户价值分层等）

- dws_content_summary：内容汇总表（TOP50 内容点击量、转化率等）

5. **ads****层**（5 张表）

- ads_product_core_overview：商品核心概览表（营收趋势、访客数等）

- ads_sku_hot_sale：SKU 热销表（销量占比、库存预警等）

- ads_price_strategy：价格策略表（价格带分布、定价建议等）

- ads_title_optimization：标题优化表（词根引流效果、优化建议等）

- ads_rfm_strategy：RFM 策略表（用户分层、商品策略等）

## 三、工单处理机制

### （一）工单类型与流程

1. **数据异常工单**

- 触发场景：看板指标异常（如销量突降、数据缺失）

- 处理流程：

1. 运营人员提交工单（注明异常指标、时间范围）

2. 数据团队接收工单，从ads层反向核查dws->dwd->ods层数据

3. 定位问题后修复数据，同步更新工单状态

4. 运营人员验证修复结果，确认工单闭环

5. **功能优化工单**

- 触发场景：新增指标需求、看板交互优化

- 处理流程：

1. 业务方提交工单（说明需求背景、预期效果）

2. 产品团队评估可行性，确定实现方案（如新增dws层汇总指标）

3. 开发团队完成开发，通过测试后上线

4. 业务方验收功能，确认工单完成

### （二）工单与数据分层的关联处理

- 针对数据准确性问题，通过工单追踪各分层数据质量，如ods层原始数据错误需同步业务系统修复，dwd层清洗逻辑问题需优化 ETL 脚本

- 针对指标计算问题，工单需明确涉及的分层表（如dws_sales_summary的总销量计算逻辑），便于精准定位

## 四、测试验证体系

### （一）测试范围与方法

1. **数据一致性测试**

- 验证内容：分层与不分层两种实现方式的指标一致性

- 测试方法：

- 分层方式：从dws/ads层直接获取指标（如dws_sales_summary的总销量）

- 不分层方式：从ods层原始数据直接计算（如ods_sales_original汇总销售数量）

- 通过自动化脚本对比两种方式的结果（如TestProduct360Dashboard测试类）

2. **功能完整性测试**

- 验证内容：15 + 关键指标的计算准确性（总销量、访客数、RFM 总分等）

- 测试方法：基于模拟数据（generate_test_data函数生成），逐一校验指标计算逻辑

3. **工单处理流程测试**

- 验证内容：工单提交、处理、闭环的全流程通畅性

- 测试方法：模拟数据异常场景，提交工单并追踪处理时效与结果

### （二）核心测试用例

|   |   |   |
|---|---|---|
|测试类型|关键用例|测试脚本关联|
|数据一致性|总销量（全量数据 / 按商品 / 按日期）|test_total_sales_all等方法|
|指标准确性|访客数（UV）、总营收、RFM 总分|test_uv_all等方法|
|流程完整性|数据异常工单的反向核查流程|工单系统模拟测试脚本|

## 五、实施建议

1. **数据分层落地**：优先搭建ods->dwd层基础架构，确保原始数据清洗规范，再逐步构建dws->ads层汇总指标

2. **工单响应机制**：建立 SLA 标准（如数据异常工单 2 小时内响应），关联数据分层责任人

3. **测试自动化**：定期运行[product_360_test.py](http://product_360_test.py)脚本，监控数据一致性，输出测试报告（如测试用例通过率、失败用例详情）

通过上述设计，商品 360 看板可实现数据全链路可追溯、业务问题高效处理、指标结果精准可靠，为商品精细化运营提供坚实支撑。


从覆盖内容来看，文稿包含了商品 360 看板设计文档所需的 ADS 层表设计、原始数据分析、关键指标实现方案等，且关键指标数量满足不少于 15 个的要求，也体现了分层与不分层两种实现方式，与验收标准中的相关内容对应。同时，融入了工单处理机制和测试验证体系，考虑到了项目落地中的问题处理和数据准确性保障。